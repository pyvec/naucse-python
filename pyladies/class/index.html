<h1 id="hodnoty_a_objekty">Hodnoty a objekty
<a href="#hodnoty_a_objekty" class="header-link">#</a>
</h1>
<p>Než se dnes začneme zabývat třídami,
podíváme na objekty.</p>
<p>Co pro programátory znamená slovo <em>objekt</em>?</p>
<p>V Pythonu je to jednoduché – každá hodnota
(tj. něco, co můžeš uložit do proměnné, vrátit
z funkce nebo třeba seznamu) je objekt.
Některé jazyky (třeba Javascript, C++ nebo Java) mají
i jiné hodnoty než objekty, v některých
jazycích (třeba v C) objekty vůbec nejsou.
Ale v Pythonu mezi hodnotou a objektem není rozdíl,
takže je na jednu stranu trošku složitější pochopit,
v čem spočívá ta „objektovitost“, ale na druhou stranu
to zase není potřeba vědět do detailů.</p>
<p>Základní vlastnost objektů je to, že obsahují jak data
(informace), tak <em>chování</em> – instrukce nebo metody,
které s těmito daty pracují.
Třeba řetězce v Pythonu obsahují jak informace
(nějakou sekvenci znaků), tak užitečné metody jako
<code>upper</code> nebo <code>count</code>.
Kdyby řetězce nebyly objekty, musel by Python mít
spoustu funkcí jako <code>str_upper</code> a <code>str_count</code>.
Objekty spojují data a funkčnost dohromady.</p>
<div class="admonition note"><p>Možná namítneš, že třeba <code>len</code> je funkce.
Je to tak, Python není „stoprocentně“ objektový jazyk.
Funkce <code>len</code> ale funguje i na
objektech, které s řetězci nemají nic společného.</p>
</div><h1 id="tridy">Třídy
<a href="#tridy" class="header-link">#</a>
</h1>
<p>Data každého objektu jsou specifická pro konkrétní
objekt (<code>"abc"</code> obsahuje jiné znaky než
<code>"def"</code>), ale funkčnost – metody – bývají
společné pro všechny objekty daného typu.
Třeba řetězcová metoda <code>count()</code> by se dala
napsat zhruba jako:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="n">retezec</span><span class="p">,</span> <span class="n">znak</span><span class="p">):</span>
    <span class="n">pocet</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">retezec</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="n">znak</span><span class="p">:</span>
            <span class="n">pocet</span> <span class="o">=</span> <span class="n">pocet</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">pocet</span>
</pre></div><p>… a ačkoliv bude vracet jinou hodnotu pro každý řetězec,
samotná metoda je společná všem řetězcům.</p>
<p>Tohle společné chování určuje
<em>typ</em> (angl. <em>type</em>) neboli <em>třída</em> (angl. <em>class</em>) daného objektu.</p>
<div class="admonition note"><p>V jiných jazycích než Python 3 můžou slova „typ“ a „třída“ označovat různé
věci. Pro nás to budou synonyma.</p>
</div><p>Typ objektu umí zjistit funkce <code>type</code>:</p>
<div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">&lt;class &#39;int&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&lt;class &#39;bool&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">)</span>
<span class="go">&lt;class &#39;str&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;soubor.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">... </span>
<span class="go">&lt;class &#39;_io.TextIOWrapper&#39;&gt;</span>
</pre></div><p>A co je to ten typ neboli třída? Je to <em>popis</em>, jak se všechny objekty
daného typu chovají.</p>
<p>Například <code>&lt;class 'int'&gt;</code> obsahuje všechno, co je společné všem celým číslům:
že (a jak) se dají sčítat, jak takové číslo převést na řetězec, a tak dále.</p>
<h2 id="tvoreni_objektu_tridy">Tvoření objektů třídy
<a href="#tvoreni_objektu_tridy" class="header-link">#</a>
</h2>
<p>Většinu tříd jde navíc v Pythonu zavolat, jako by
to byly funkce, a vytvořit tak nový objekt dané třídy:</p>
<div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trida_retezcu</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trida_retezcu</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="go">&#39;8&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trida_retezcu</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">&#39;[1, 2, 3]&#39;</span>
</pre></div><p>Chová se to stejně jako funkce <code>str</code>! Není to podivné?</p>
<p>Tady se musím omluvit:
<a href="naucse:page?lesson=beginners/functions">materiály k funkcím</a>
tak trochu lhaly. Funkce <code>str</code>, <code>int</code>, <code>float</code> apod. totiž vůbec
nejsou funkce – jsou to právě třídy:</p>
<div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span>
<span class="go">&lt;class &#39;str&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="s1">&#39;abcdefgh&#39;</span><span class="p">)</span>
<span class="go">&lt;class &#39;str&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="s1">&#39;abcdefgh&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span>
<span class="go">True</span>
</pre></div><p>Ale dají se, podobně jako funkce, zavolat.
Třída tedy většinou obsahuje nejen „popis“, jak se
její objekty budou chovat, ale „umí“ takové objekty i vytvořit.</p>
<h2 id="vlastni_tridy">Vlastní třídy
<a href="#vlastni_tridy" class="header-link">#</a>
</h2>
<p>A proč najednou tolik informací o třídách?
Protože si zkusíme napsat třídu vlastní.</p>
<p>Třídu se hodí napsat, když plánuješ mít ve svém
programu více objektů s podobným chováním.
Třeba karetní hra by mohla mít třídu Karta,
webová aplikace třídu Uživatel,
tabulkový procesor třídu Řádek.</p>
<p>My teď potřebujeme napsat program o zvířátkách.
Začni tím, že napíšeš třídu pro koťátka, která umí mňoukat:</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Kotatko</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">zamnoukej</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mňau!&quot;</span><span class="p">)</span>
</pre></div><p>Tak jako se funkce definují pomocí <code>def</code>,
třídy mají klíčové slovo <code>class</code>,
za které napíšeš jméno třídy, dvojtečku a pak odsazené tělo třídy.
Podobně jako <code>def</code> dělá funkce, příkaz
<code>class</code> udělá novou třídu a přiřadí ji
do proměnné daného jména (tady <code>Kotatko</code>).</p>
<p>Třídy se tradičně pojmenovávají s velkým písmenem,
aby se nepletly s „normálními“ hodnotami.</p>
<div class="admonition note"><p>Základní třídy (<code>str</code>, <code>int</code> atd.)
velká písmena nemají, a to hlavně z historických
důvodů – původně to byly opravdu funkce.</p>
</div><p>V těle třídy můžeš definovat metody, které vypadají
úplně jako funkce – jen mají první parametr <code>self</code>.
Ten si ale vysvětlíme později – napřed zkus zamňoukat:</p>
<div class="highlight"><pre><span></span><span class="c1"># Vytvoření konkrétního objektu</span>
<span class="n">mourek</span> <span class="o">=</span> <span class="n">Kotatko</span><span class="p">()</span>

<span class="c1"># Volání metody</span>
<span class="n">mourek</span><span class="o">.</span><span class="n">zamnoukej</span><span class="p">()</span>
</pre></div><p>V tomhle příkladu si dej pozor na velikost písmen:
<code>Kotatko</code> (s velkým K) je třída – popis, jak
se koťátka chovají.
<code>mourek</code> (s malým m)
je konkrétní objekt (angl. <em>instance</em>) té třídy:
hodnota, která reprezentuje kotě.</p>
<p>Když definuješ třídu (pomocí bloku <code>class</code>), neznamená to zatím, že ve tvém
programu je nějaké koťátko.
Třída je jako recept nebo manuál: když si koupíš kuchařku, budeš teoreticky
vědět jak upéct dort, jak bude takový dort vypadat a že se dá sníst.
Ale neznamená to ještě, že máš samotný dort!</p>
<p>Konkrétní objekt vytvoříš až zavoláním třídy.
Stejně jako zavoláním <code>str()</code> se dá vytvořit konkrétní řetězec,
volání <code>Kotatko()</code> vytvoří nový objekt tvé třídy, který už můžeš použít.</p>
<p>Mňau!</p>
<h2 id="atributy">Atributy
<a href="#atributy" class="header-link">#</a>
</h2>
<p>Objekty vytvořené z „vlastních“ tříd mají funkčnost, kterou třídy jako <code>str</code>
nedovolují: máš možnost si definovat vlastní
<em>atributy</em> – informace, které se uloží k danému objektu.
Atributy se označují tak, že mezi hodnotu a jméno
jejího atributu napíšeš tečku:</p>
<div class="highlight"><pre><span></span><span class="n">mourek</span> <span class="o">=</span> <span class="n">Kotatko</span><span class="p">()</span>
<span class="n">mourek</span><span class="o">.</span><span class="n">jmeno</span> <span class="o">=</span> <span class="s1">&#39;Mourek&#39;</span>

<span class="n">micka</span> <span class="o">=</span> <span class="n">Kotatko</span><span class="p">()</span>
<span class="n">micka</span><span class="o">.</span><span class="n">jmeno</span> <span class="o">=</span> <span class="s1">&#39;Micka&#39;</span>

<span class="nb">print</span><span class="p">(</span><span class="n">mourek</span><span class="o">.</span><span class="n">jmeno</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">micka</span><span class="o">.</span><span class="n">jmeno</span><span class="p">)</span>
</pre></div><p>Na začátku jsme si řekli, že objekty spojují chování
a data.
Chování je definováno ve třídě; data se schovávají
právě v atributech jednotlivých objektů.
Podle atributů jako <code>jmeno</code> pak můžeš jednotlivá koťátka
rozlišit.</p>
<div class="admonition note"><p>Asi sis všiml/a, že tečkou se dostaneš jak k metodám
převzaným z třídy, tak k atributům specifickým
pro konkrétní objekt.
Co se stane, když má atribut stejné jméno jako
metoda z třídy? Vyzkoušej si to:</p>
<div class="highlight"><pre><span></span><span class="n">micka</span> <span class="o">=</span> <span class="n">Kotatko</span><span class="p">()</span>
<span class="n">micka</span><span class="o">.</span><span class="n">zamnoukej</span> <span class="o">=</span> <span class="mi">12345</span>
<span class="n">micka</span><span class="o">.</span><span class="n">zamnoukej</span><span class="p">()</span>
</pre></div></div><h2 id="parametr_codeselfcode">Parametr <code>self</code>
<a href="#parametr_codeselfcode" class="header-link">#</a>
</h2>
<p>Teď se na chvíli vraťme k metodám. Konkrétně k parametru <code>self</code>.</p>
<p>Každá metoda má přístup ke konkrétnímu objektu, na
kterém pracuje, právě přes parametr <code>self</code>.
Teď, když máš koťátka pojmenovaná, můžeš v metodě <code>zamnoukej</code> použít <code>self</code>
a dostat se tak ke jménu daného koťátka:</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Kotatko</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">zamnoukej</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">jmeno</span><span class="si">}</span><span class="s2">: Mňau!&quot;</span><span class="p">)</span>

<span class="n">mourek</span> <span class="o">=</span> <span class="n">Kotatko</span><span class="p">()</span>
<span class="n">mourek</span><span class="o">.</span><span class="n">jmeno</span> <span class="o">=</span> <span class="s1">&#39;Mourek&#39;</span>

<span class="n">micka</span> <span class="o">=</span> <span class="n">Kotatko</span><span class="p">()</span>
<span class="n">micka</span><span class="o">.</span><span class="n">jmeno</span> <span class="o">=</span> <span class="s1">&#39;Micka&#39;</span>

<span class="n">mourek</span><span class="o">.</span><span class="n">zamnoukej</span><span class="p">()</span>
<span class="n">micka</span><span class="o">.</span><span class="n">zamnoukej</span><span class="p">()</span>
</pre></div><p>Co se stalo? Výraz <code>mourek.zamnoukej</code> udělá <em>metodu</em>.
Když ji pak zavoláš (<code>mourek.zamnoukej()</code>),
objekt <code>mourek</code> se předá funkci <code>zamnoukej</code> jako první argument, <code>self</code>.</p>
<div class="admonition note"><p>Onen první parametr metody můžeš teoreticky pojmenovat i jinak než <code>self</code>,
ale když to uděláš, ostatní programátoři se na tebe budou koukat hodně divně.</p>
</div><p>Metoda může mít po <code>self</code> i další parametry.
Při volání <code>self</code> vynecháš – doplní se vždy automaticky – ale ostatní
se předávají jako u normálního volání funkce.
Třeba v tomto příkladu se jako <code>jidlo</code> předá řetězec <code>'ryba'</code>:</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Kotatko</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">zamnoukej</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">jmeno</span><span class="si">}</span><span class="s2">: Mňau!&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">snez</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">jidlo</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">jmeno</span><span class="si">}</span><span class="s2">: Mňau mňau! </span><span class="si">{</span><span class="n">jidlo</span><span class="si">}</span><span class="s2"> mi chutná!&quot;</span><span class="p">)</span>

<span class="n">mourek</span> <span class="o">=</span> <span class="n">Kotatko</span><span class="p">()</span>
<span class="n">mourek</span><span class="o">.</span><span class="n">jmeno</span> <span class="o">=</span> <span class="s1">&#39;Mourek&#39;</span>
<span class="n">mourek</span><span class="o">.</span><span class="n">snez</span><span class="p">(</span><span class="s1">&#39;ryba&#39;</span><span class="p">)</span>
</pre></div><h2 id="metoda_code__init__code">Metoda <code>__init__</code>
<a href="#metoda_code__init__code" class="header-link">#</a>
</h2>
<p>Co se stane, když koťátku zapomeneš nastavit jméno?
Metoda <code>zamnoukej</code> přestane fungovat:</p>
<div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">micka</span> <span class="o">=</span> <span class="n">Kotatko</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">micka</span><span class="o">.</span><span class="n">snez</span><span class="p">(</span><span class="s1">&#39;ryba&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;zvirata.py&gt;&quot;</span>, line <span class="m">5</span>, in <span class="n">snez</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;Kotatko&#39; object has no attribute &#39;jmeno&#39;</span>
</pre></div><p>Aby tahle chyba nemohla nastat, můžeš zařídit, aby každé kotě <em>muselo</em> být
pojmenované už od okamžiku, kdy vznikne.
Jméno pak budeš zadávat už při vytváření kotěte, nějak takhle:</p>
<div class="highlight"><pre><span></span><span class="n">mourek</span> <span class="o">=</span> <span class="n">Kotatko</span><span class="p">(</span><span class="n">jmeno</span><span class="o">=</span><span class="s1">&#39;Mourek&#39;</span><span class="p">)</span>
</pre></div><p>To ale zatím nefunguje; musíš na to třídu <code>Kotatko</code> připravit.</p>
<p>Použij na to speciální metodu, která se jmenuje <code>__init__</code> (dvě podtržítka,
<code>init</code>, dvě podtržítka).
To „opodtržítkování“ znamená, že tohle jméno je nějakým způsobem speciální.
Metodu <code>__init__</code> totiž Python zavolá
automaticky, když vytvoří nový objekt.
Můžeš tedy napsat:</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Kotatko</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">jmeno</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jmeno</span> <span class="o">=</span> <span class="n">jmeno</span>

    <span class="k">def</span> <span class="nf">zamnoukej</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">jmeno</span><span class="si">}</span><span class="s2">: Mňau!&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">snez</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">jidlo</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">jmeno</span><span class="si">}</span><span class="s2">: Mňau mňau! </span><span class="si">{</span><span class="n">jidlo</span><span class="si">}</span><span class="s2"> mi chutná!&quot;</span><span class="p">)</span>

<span class="n">mourek</span> <span class="o">=</span> <span class="n">Kotatko</span><span class="p">(</span><span class="s1">&#39;Mourek&#39;</span><span class="p">)</span>
<span class="n">mourek</span><span class="o">.</span><span class="n">zamnoukej</span><span class="p">()</span>
</pre></div><p>A teď už není možnost jak vytvořit koťátko beze jména.
Metoda <code>zamnoukej</code> bude vždycky fungovat.</p>
<p>Jako u jiných funkcí je možné jméno koťátka zadat buď jako pojmenovaný
argument, nebo jako poziční. Obojí funguje stejně:</p>
<div class="highlight"><pre><span></span><span class="n">mourek</span> <span class="o">=</span> <span class="n">Kotatko</span><span class="p">(</span><span class="s1">&#39;Mourek&#39;</span><span class="p">)</span>  <span class="c1"># &#39;Mourek&#39; je hodnota prvního argumentu pro __init__ (po self)</span>
<span class="n">micka</span> <span class="o">=</span> <span class="n">Kotatko</span><span class="p">(</span><span class="n">jmeno</span><span class="o">=</span><span class="s1">&#39;Micka&#39;</span><span class="p">)</span>  <span class="c1"># &#39;Micka&#39; je hodnota argumentu `jmeno`</span>
</pre></div><h3 id="metoda_code__str__code">Metoda <code>__str__</code>
<a href="#metoda_code__str__code" class="header-link">#</a>
</h3>
<p>Podobných „opodtržítkovaných“ (speciálních) metod je víc.
Třeba metodu <code>__str__</code> Python zavolá, když je potřeba
převést objekt na řetězec:</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Kotatko</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">jmeno</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jmeno</span> <span class="o">=</span> <span class="n">jmeno</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;&lt;Kotatko jmenem </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">jmeno</span><span class="si">}</span><span class="s1">&gt;&#39;</span>

    <span class="k">def</span> <span class="nf">zamnoukej</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">jmeno</span><span class="si">}</span><span class="s2">: Mňau!&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">snez</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">jidlo</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">jmeno</span><span class="si">}</span><span class="s2">: Mňau mňau! </span><span class="si">{</span><span class="n">jidlo</span><span class="si">}</span><span class="s2"> mi chutná!&quot;</span><span class="p">)</span>

<span class="n">mourek</span> <span class="o">=</span> <span class="n">Kotatko</span><span class="p">(</span><span class="s1">&#39;Mourek&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mourek</span><span class="p">)</span>
</pre></div><p>A to je o samotných třídách zatím vše.
<a href="naucse:page?lesson=beginners/inheritance">Příště</a> si něco řekneme o dědičnosti.
A o štěňátkách.</p>